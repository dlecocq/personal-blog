---
layout: post
status: publish
published: true
title: Make With Multiple Cores
author:
  display_name: ''
  login: ''
  email: ''
  url: ''
wordpress_id: 125
wordpress_url: http://dan.lecocq.us/wordpress/2008/10/11/make-with-multiple-cores/
date: '2008-10-11 20:09:12 -0700'
date_gmt: '2008-10-12 03:09:12 -0700'
categories:
- computer science
tags:
- make
- multiple cores
- building
- ninja magic
comments: []
---
<p>I was building something, and I remembered a friend was saying a while ago that you could tell gcc how many cores to use when building something.  I don't know if that's true or not, but it turns out you can certainly tell make:<br />
<code><br />
make -j(number of cores to use)<br />
<&#47;code></p>
<p>For example,<br />
<code><br />
make -j2<br />
<&#47;code></p>
<p>I took a screen capture of System Monitor after building each way (make and make -j2), to see the difference.  The first box is using just one core, and the second is using both.</p>
<p><a href='http:&#47;&#47;dan.lecocq.us&#47;wordpress&#47;wp-content&#47;uploads&#47;2008&#47;10&#47;multicore-make.png' title='Multicore Make'><img src='http:&#47;&#47;dan.lecocq.us&#47;wordpress&#47;wp-content&#47;uploads&#47;2008&#47;10&#47;multicore-make.thumbnail.png' alt='Multicore Make' &#47;><&#47;a></p>
<p>I had initially thought I'd have to tell gcc, and so I had planned to edit the makefile to automatically find the number of cores on the system, and then run gcc with that as an argument, so I went in search of how to find the number of cores on a Linux system.  It turns out the easiest way to get that number that I came across was to use &#47;proc&#47;cpuinfo:<br />
<code><br />
cat &#47;proc&#47;cpuinfo | grep 'cpu cores' | head -1 | sed -r 's&#47;^.+([[:digit:]]+)&#47;1&#47;'<br />
<&#47;code></p>
